#####################################
#####################################
##HITS Y FALSAS ALARMAS
rm(list=ls())
layout(matrix(1:2,ncol=1))
for(archive in dir()){
jaime <- read.csv(archive)
fa_AN <- NULL
hits_AN <- NULL
fa_AS <- NULL
fa_AS <- NULL
hits_AN <- NULL
hits_AS <- NULL
hits_BS <- NULL
hits_BN <- NULL
{ fa_AN <- sum(jaime$Falsas.alarmas[jaime$Estimulo>=161&jaime$Estimulo<=320]=='True')
fa_AS <- sum(jaime$Falsas.alarmas[jaime$Estimulo>=1&jaime$Estimulo<=160]=='True')
hits_AS <- sum(jaime$Hits[jaime$Estimulo>=1&jaime$Estimulo<=160]=='True')
hits_AN <- sum(jaime$Hits[jaime$Estimulo>=161&jaime$Estimulo<=320]=='True')
fa_BN <- sum(jaime$Falsas.alarmas[jaime$Estimulo>=481&jaime$Estimulo<=640]=='True')
fa_BS <- sum(jaime$Falsas.alarmas[jaime$Estimulo>=321&jaime$Estimulo<=480]=='True')
hits_BS <- sum(jaime$Hits[jaime$Estimulo>=321&jaime$Estimulo<=480]=='True')
hits_BN <- sum(jaime$Hits[jaime$Estimulo>=481&jaime$Estimulo<=640]=='True')
FAr_an <- fa_AN/160
Hr_as <- hits_AS/160
FAr_bn <- fa_BN/160
Hr_bs <- hits_BS/160
print(c(fa_AN[length(fa_AN)],
FAr_an[length(FAr_an)],
fa_BN[length(fa_BN)],
FAr_bn[length(FAr_bn)],
hits_BS[length(hits_BS)],
Hr_bs[length(Hr_bs)],
hits_AS[length(hits_AS)],
Hr_as[length(Hr_as)]))
k_A <- qnorm(1-FAr_an,0,1)
d_A <- qnorm(Hr_as,0,1)-qnorm(FAr_an,0,1)
c_A <- k_A-(d_A/2)
beta_A <- dnorm(k_A,d_A,1)/dnorm(k_A,0,1)
k_B <- qnorm(1-FAr_bn,0,1)
d_B <-qnorm(Hr_bs,0,1)-qnorm(FAr_bn,0,1)
c_B <-k_B-(d_B/2)
beta_B <-dnorm(k_B,d_B,1)/dnorm(k_B,0,1)
}
####### Outcome
plot(beta_B,type='o',pch=16,col='white',ylim=c(0,10), yaxt='n', xaxt='n', ann=F)
axis(1,at=c(0.7,0.9,1.1,1.3),labels=c("AN","BN","BS","AS"))
axis(2,at=c(2.5,7.5),labels=c("Rate","No."),las=0)
abline(5,c(0.1,0.1), col="black",lwd=1)
abline(v=.8,h=c(-10,15),col='black')
abline(v=1,h=c(-10,15),col='black')
abline(v=1.2,h=c(-10,15),col='black')
text(.7,2.5,paste(FAr_an),cex=1,col='royalblue4')
text(.9,2.5,paste(FAr_bn),cex=1,col='royalblue4')
text(1.1,2.5,paste(Hr_bs),cex=1,col='royalblue4')
text(1.3,2.5,paste(Hr_as),cex=1,col='royalblue4')
text(.7,7.5,paste(fa_AN),cex=1,col='lightblue4')
text(.9,7.5,paste(fa_BN),cex=1,col='lightblue4')
text(1.1,7.5,paste(hits_BS),cex=1,col='lightblue4')
text(1.3,7.5,paste(hits_AS),cex=1,col='lightblue4')
mtext(archive,3,cex=.8)
#text(1.5,.8,paste('Hits & F.A. rate'),cex=1,col='blue',f=2)
#mtext(archive,3,cex=.8)
title("Yes/No Task", outer = TRUE, line = -2)
#points(hits,type='o',pch=16,col='black')
fa <- NULL
hits <- NULL
conf <- NULL
for(nce in sort(unique(jaime$tipo))){
fa <- append(fa, sum(jaime$Falsas.alarmas[jaime$tipo==nce]=='True'))
hits <- append(hits, sum(jaime$Hits[jaime$tipo==nce]=='True'))
rate <- (fa+hits)/160
print(c(nce,
fa[length(fa)],
hits[length(hits)],
rate[length(rate)]))
}
plot(rate,type='o',pch=16,col='royalblue',ylim=c(0,1),axes=F , ann=F)
axis(1,at=1:4,labels=sort(unique(jaime$tipo)))
axis(2,at=c(0, 0.15, 0.30, 0.45, 0.60, 0.75, 0.90, 1),labels=c("0",".15",".30",".45",".60", ".75", ".90", "1"),las=1)
text(1.1,rate[1]+.1,paste(rate[1]),cex=1,col='blue',f=2)
text(1.9,rate[2]+.1,paste(rate[2]),cex=1,col='blue',f=2)
text(3.1,rate[3]-.1,paste(rate[3]),cex=1,col='blue',f=2)
text(3.9,rate[4]-.1,paste(rate[4]),cex=1,col='blue',f=2)
text(1.5,.8,paste('Hits & F.A. rate'),cex=1,col='blue',f=2)
}
#points(hits,type='o',pch=16,col='red')
######Confidence Rating
rm(list=ls())
layout(matrix(1:2,ncol=1))
for(archive in dir()){
jaime <- read.csv(archive)
C_AS <- NULL
C_AN <- NULL
C_BS <- NULL
C_BN <- NULL
for(nce in sort(jaime$Estimulo)){
C_AS <- sum(jaime$Confidence[jaime$tipo=='4 AS'])/160
C_AN <- sum(jaime$Confidence[jaime$tipo=='1 AN'])/160
C_BS <- sum(jaime$Confidence[jaime$tipo=='3 BS'])/160
C_BN <- sum(jaime$Confidence[jaime$tipo=='2 BN'])/160
Confidence <- c(C_AN, C_BN, C_BS, C_AS)
}
plot(Confidence,type='o',pch=16,col='white',ylim=c(0,6), yaxt='n', xaxt='n', ann=F)
#axis(1,at=c(0,6),labels=c("AN","BN","BS","AS"), col='white')
#axis(2,at=c(2.5,7.5),labels=c("Rate","No."),las=0)
abline(3,c(0.1,0.1), col="black",lwd=1)
abline(v=1.75,h=c(-10,15),col='black')
abline(v=2.5,h=c(-10,15),col='black')
abline(v=3.4,h=c(-10,15),col='black')
text(1.3,1.5,paste(C_AN),cex=1,col='royalblue4')
text(2.2,1.5,paste(C_BN),cex=1,col='royalblue4')
text(2.9,1.5,paste(C_BS),cex=1,col='royalblue4')
text(3.75,1.5,paste(C_AS),cex=1,col='royalblue4')
text(1.3,4.5,paste('R(AN)'),cex=1,col='royalblue4')
text(2.2,4.5,paste('R(BN)'),cex=1,col='royalblue4')
text(2.9,4.5,paste('R(BS)'),cex=1,col='royalblue4')
text(3.75,4.5,paste('R(AS)'),cex=1,col='royalblue4')
mtext(archive,3,cex=.8)
#text(1.5,.8,paste('Hits & F.A. rate'),cex=1,col='blue',f=2)
#mtext(archive,3,cex=.8)
title("Confidence Rating", outer = TRUE, line = -2)
#points(hits,type='o',pch=16,col='black')
plot(Confidence,type='o',pch=16,col='maroon2',ylim=c(0,6),axes=F , ann=F)
axis(1,at=1:4,labels=sort(unique(jaime$tipo)))
axis(2,at=c(0, 1, 2, 3, 4, 5, 6),labels=c("0","1", "2","3","4","5","6"),las=1)
text(1.1,C_AN+.5,paste(C_AN),cex=1,col='violetred',f=2)
text(1.9,C_BN+.5,paste(C_BN),cex=1,col='violetred',f=2)
text(3.1,C_BS+.5,paste(C_BS),cex=1,col='violetred',f=2)
text(3.9,C_BS+.5,paste(C_AS),cex=1,col='violetred',f=2)
text(1.5,5.5,paste('Confidence Rate'),cex=1,col='violetred4',f=2)
}
####################################################
####################################################
##################### Aciertos y errores x Ensayo
rm(list=ls())
layout(matrix(1:4,ncol=2))
for(archive in dir()){
jaime <- read.csv(archive)
jaime$Ensayo <- as.character(jaime$Ensayo)
cafe <- strsplit(as.character(jaime$Ensayo),split='-')
plot(jaime$Aciertos,type='o',pch=16, col='green', lwd=.5, ylim=c(0,640),axes=F , ann = F )
axis(1,at=1:640,labels=c(1:640))
#axis(2,at=0:10,labels=c("0", "1","2","3","4","5","6","7","8","9","10"))
points(jaime$Errores,type='o', lty=1, lwd=.5, pch=16, col='red')
mtext("Experiment 2 - P. 3",3,cex=.8)
text(70,500,paste('Right'),cex=1,col='chartreuse4',f=2)
text(70,400,paste('Wrong'),cex=1,col='red',f=2)
title("Performance across time", outer = TRUE, line = -2)
plot(jaime$Exito[1:215],type='o',pch=16, col='darkgreen',ylim=c(0,1),axes=F , ann = F )
axis(1,at=1:215,labels=c(1:215))
axis(2,at=c(0,1), labels=c('Fail', 'Success'))
mtext('1-215',3,cex=.8)
plot(jaime$Exito[216:430],type='o',pch=16, col='darkgreen',ylim=c(0,1),axes=F , ann = F )
axis(1,at=1:215,labels=c(216:430))
axis(2,at=c(0,1), labels=c('Fail', 'Success'))
mtext('216-430',3,cex=.8)
plot(jaime$Exito[431:640],type='o',pch=16, col='darkgreen',ylim=c(0,1),axes=F , ann = F )
axis(1,at=1:210,labels=c(431:640))
axis(2,at=c(0,1), labels=c('Fail', 'Success'))
mtext('431-640',3,cex=.8)
title("Performance across time", outer = TRUE, line = -2)
}
#############################################
#############################################
######### Contadores x Ensayo
rm(list=ls())
layout(matrix(1:2,ncol=1, byrow=TRUE))
for(archive in dir()){
jaime <- read.csv(archive)
jaime$Ensayo <- as.character(jaime$Ensayo)
cafe <- strsplit(as.character(jaime$Ensayo),split='-')
a <- c(1,20,40,60,80,100,120,140,160,180,200,220,240,260,280,300,320,340,360,380,400,420,440,460,480,500,520,540,560,580,600,620,640)
plot(jaime$ContadorH,type='o',pch=16, col='blue',ylim=c(0,320), xlab='Trial', ylab="", axes=F, font.lab=2)
axis(1,at=a,labels=a)
#axis(2,at=0:10,labels=c("0", "1","2","3","4","5","6","7","8","9","10"))
points(jaime$ContadorF,type='o', lty=3, pch=16, col='red')
points(jaime$ContadorM,type='o', lty=3, pch=16, col='purple')
points(jaime$ContadorR,type='o', lty=3, pch=16, col='green')
text(646,jaime$ContadorF[639]+20,paste("FA"),cex=1,col='red',f=2)
axis(2,at=160, labels="Cumulative Frequency", tck=0, line=-0.5, font=2)
text(646,jaime$ContadorM[630]+20,paste("M"),cex=1,col='purple',f=2)
text(646,jaime$ContadorR[639]+20,paste("R"),cex=1,col='green',f=2)
text(646,jaime$ContadorH[639]+20,paste("H"),cex=1,col='blue',f=2)
title("Counters across time", line = 3)
mtext("(Experiment 2 - P. 5)", 3, line=1, col='black', cex=1, font=3)
plot(jaime$outcome[1:640],type='o',pch=16, col='deepskyblue4',ylim=c(1,4),axes=F, ylab="", xlab="Trial", font.lab=2 )
axis(1,at=a,labels=a)
axis(2,at=c(1,2,3,4), labels=c('F.Alarm', 'Miss', 'Rejection', 'Hit'))
}
#######################
######################
######################
#Response Time (1 y 2) across trials
rm(list=ls())
layout(matrix(1:4,ncol=2))
for(archive in dir()){
jaime <- read.csv(archive)
jaime$Ensayo <- as.character(jaime$Ensayo)
cafe <- strsplit(as.character(jaime$Ensayo),split='-')
plot(jaime$RTime1,type='o',pch=16, col='purple',ylim=c(0,16),axes=F , ann = F )
axis(1,at=1:640,labels=sort(unique(jaime$Ensayo)))
axis(2,at=c(0,2,4,6,8,10,12,14,16),labels=c("0","2","4","6","8","10","12","14","16"))
points(jaime$RTime2,type='o', lty=3, pch=16, col='brown')
text(100,14,paste('Stimulus'),cex=1,col='purple',f=2)
text(100,10,paste('Rating'),cex=1,col='brown',f=2)
mtext(archive,3,cex=.8)
title("Response Time per trial", outer = TRUE, line = -2)
}
################################
################################
#RT en Intervalos de 150 ensayos.
rm(list=ls())
rm(list=ls())
layout(matrix(1:2,ncol=1))
for(archive in dir()){
jaime <- read.csv(archive)
jaime$Ensayo <- as.character(jaime$Ensayo)
cafe <- strsplit(as.character(jaime$Ensayo),split='-')
a <- c(1,10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320)
b <- c(321,330,340,350,360,370,380,390,400,410,420,430,440,450,460,470,480,490,500,510,520,530,540,550,560,570,580,590,600,610,620,630,640)
{plot(jaime$RTime1[1:320],type='o',pch=16, col='darkorange',ylim=c(1,10),axes=F , ylab='Seconds', xlab='Trials', font.lab=2)
axis(1,at=a,labels=a)
axis(2,at=0:10,labels=c(0:10))
mtext("(Experiment 2 - P. 8)", 3, line=1, col='black', cex=1, font=3)
title("Response time per Trial (Stimulus)",line = 3)
plot(jaime$RTime1[321:640],type='o',pch=16, col='darkorange1',ylim=c(1,10),axes=F , ylab='Seconds', xlab='Trials', font.lab=2)
axis(1,at=a,labels=b)
axis(2,at=0:10,labels=c(0:10))
}
{plot(jaime$RTime2[1:320],type='o',pch=16, col='violetred1',ylim=c(0,10),axes=F , ylab='Seconds', xlab='Trials', font.lab=2)
axis(1,at=a,labels=a)
axis(2,at=0:10,labels=c(0:10))
mtext("(Experiment 2 - P. 8)", 3, line=1, col='black', cex=1, font=3)
title( "Response Time per Trial (Rating)", line = 3)
plot(jaime$RTime2[321:640],type='o',pch=16, col='violetred3',ylim=c(0,10),axes=F , ylab='Seconds', xlab='Trials', font.lab=2)
axis(1,at=a,labels=b)
axis(2,at=0:10,labels=c(0:10))
}}
############################
############################
######### Confidence por ENSAYO
rm(list=ls())
layout(matrix(1:2,ncol=1))
for(archive in dir()){
a <- c(1,10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320)
b <- c(321,330,340,350,360,370,380,390,400,410,420,430,440,450,460,470,480,490,500,510,520,530,540,550,560,570,580,590,600,610,620,630,640)
jaime <- read.csv(archive)
jaime$Ensayo <- as.character(jaime$Ensayo)
cafe <- strsplit(as.character(jaime$Ensayo),split='-')
plot(jaime$Confidence[1:320],type='o',pch=16, col='darkorchid',ylim=c(1,6),axes=F , ylab='Confidence', xlab='Trial', font.lab=2)
axis(1,at=a,labels=a)
axis(2,at=1:6,labels=c("1","2","3","4","5","6"))
text(140,9.5,paste("1-160"),cex=1,col='darkorchid',f=2)
title( "Confidence Rating per Trial", line = 3)
mtext("(Experiment 2 - P. 12)", 3, line=1, col='black', cex=1, font=3)
plot(jaime$Confidence[321:640],type='o',pch=16, col='darkorchid2',ylim=c(1,6), ylab='Confidence',xlab='Trial', axes=F, font.lab=2 )
axis(1,at=a,labels=b)
axis(2,at=1:6,labels=c("1","2","3","4","5","6"))
text(140,8.5,paste("321-480"),cex=1,col='darkorchid2',f=2)
}
############################
######### Choice por ENSAYO
rm(list=ls())
layout(matrix(1:2,ncol=1))
for(archive in dir()){
jaime <- read.csv(archive)
jaime$Ensayo <- as.character(jaime$Ensayo)
cafe <- strsplit(as.character(jaime$Ensayo),split='-')
a <- c(1,10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320)
b <- c(321,330,340,350,360,370,380,390,400,410,420,430,440,450,460,470,480,490,500,510,520,530,540,550,560,570,580,590,600,610,620,630,640)
plot(jaime$choice[1:320],type='o',pch=16, col='darkorchid',ylim=c(0,1),axes=F , ylab='Response', xlab='Trial', font.lab=2 )
axis(1,at=a,labels=a)
axis(2,at=0:1,labels=c("No","Yes"))
text(140,9.5,paste("1-160"),cex=1,col='darkorchid',f=2)
title( "Response per Trial", line = 3)
mtext("(Experiment 2 - P. 12)", 3, line=1, col='black', cex=1, font=3)
plot(jaime$choice[321:640],type='o',pch=16, col='darkorchid2',ylim=c(0,1),axes=F , ylab='Response', xlab='Trial', font.lab=2 )
axis(1,at=a,labels=b)
axis(2,at=0:1,labels=c("No","Yes"))
text(140,8.5,paste("321-480"),cex=1,col='darkorchid2',f=2)
}
############################
############################
# Hits y Falsas alarmas x  No. Circulos externos
rm(list=ls())
layout(matrix(1:2,ncol=2))
for(archive in dir()){
jaime <- read.csv(archive)
jaime$num_circulos_externos <- as.character(jaime$num_circulos_externos)
cafe <- strsplit(as.character(jaime$num_circulos_externos),split='-')
#index <- which(jaime$facilidad=='muchos')
#for(i in index){
#  jaime$num_circulos_externos[i] <- paste(as.numeric(cafe[[i]])+5,collapse = '-')
#
fa <- NULL
hits <- NULL
for(nce in sort(unique(jaime$num_circulos_externos))){
fa <- append(fa, sum(jaime$Falsas.alarmas[jaime$num_circulos_externos==nce]=='True'))
hits <- append(hits,sum(jaime$Hits[jaime$num_circulos_externos==nce]=='True'))
print(c(nce,
fa[length(fa)],
hits[length(hits)]))
}
#plot(hits,type='o',pch=16,col='blue',ylim=c(50,100),axes=F , xlab='No. External Circles', ylab='', font.lab=2)
#axis(1,at=1:4,labels=sort(unique(jaime$num_circulos_externos)))
#axis(2,at=c(50, 60, 70, 80, 90, 100),labels=c("50","60","70","80","90","100"),las=1)
#points(fa,type='o',pch=16,col='red')
##mtext(archive,3,cex=.8)
#text(3.5,90,paste('Hits'),cex=1,col='blue',f=2)
#title("Hits & F. Alarms per No. External Circles", outer = TRUE, line = -2)
barplot(hits, main = "", xlab = "", ylab = " ", ylim = c(0, 100), axes = FALSE, col = c("dodgerblue1","dodgerblue2","dodgerblue3","dodgerblue4"))
axis(2,at=c(0, 20, 40, 60, 80, 100),labels=c("0", "20", "40","60","80","100"),las=1)
axis(1,at=c(0.7,1.9,3.1,4.3),labels=c("2","3", "7", "8"))
mtext("Number of External Circles", side = 1, line = 2.5, cex = 1, font = 1)
mtext("Hits", side = 2, line = 3, cex = 1, font = 1, las = 0)
mtext('Hits per External Circles',3,cex=1.2, font=2)
title('Experiment 1 - P.10', outer = TRUE, line = -2)
#plot(fa,type='o',pch=16,col='red',ylim=c(0,50),axes=F , xlab='No. External Circles', ylab='', font.lab=2)
#axis(1,at=1:4,labels=sort(unique(jaime$num_circulos_externos)))
#axis(2,at=c(0, 10, 20, 30, 40, 50),labels=c("0", "10","20","30","40","50"),las=1)
#points(fa,type='o',pch=16,col='red')
#text(1.5,40,paste('F.A'),cex=1,col='red',f=2)
#mtext("(Experiment 2)", 3, line=3, col='black', cex=1, font=3)
#mtext(archive,3,cex=.8)
barplot(fa, main = "", xlab = "", ylab = " ", ylim = c(0, 100), axes = FALSE, col = c("firebrick1","firebrick2","firebrick3", "firebrick4"))
axis(2,at=c(0, 20, 40, 60, 80, 100),labels=c("0", "20", "40","60","80","100"),las=1)
axis(1,at=c(0.7,1.9,3.1,4.3),labels=c("2","3", "7", "8"))
mtext("Number of External Circles", side = 1, line = 2.5, cex = 1, font = 1)
mtext("Hits", side = 2, line = 3, cex = 1, font = 1, las = 0)
mtext('F. Alarms per External Circles',3,cex=1.2, font=2)
# title(archive, outer = TRUE, line = -2)
}
############################3
#Hits y Falsas Alarmas x Color
rm(list=ls())
layout(matrix(1:2,ncol=2, byrow = TRUE))
for(archive in dir()){
jaime <- read.csv(archive)
jaime$color <- as.character(jaime$color)
cafe <- strsplit(as.character(jaime$color),split='-')
#index <- which(jaime$facilidad=='muchos')
fa <- NULL
hits <- NULL
for(nce in sort(unique(jaime$color))){
fa <- append(fa, sum(jaime$Falsas.alarmas[jaime$color==nce]=='True'))
hits <- append(hits,sum(jaime$Hits[jaime$color==nce]=='True'))
print(c(nce,
fa[length(fa)],
hits[length(hits)]))
}
#par(cex.main = 1.5, mar = c(5, 6, 4, 5) + 0.1, mgp = c(3.5, 1, 0), cex.lab = 1.5 , font.lab = 2, cex.axis = 1.3, bty = "n", las=1)
#plot(hits,type='o',pch=16,col='blue',ylim=c(40,90),axes=F , xlab="", ylab="")
#axis(2,at=c(40, 50, 60, 70, 80, 90),labels=c("40", "50","60","70","80", "90"),las=1)
#axis(1,at=1:5,labels=c("Blue","Red", "Orange", "Purple", "Green"))
#points(fa,type='o',pch=16,col='red')
#text(2,70,paste('Hits'),cex=1,col='blue',f=2)
#mtext("Color", side = 1, line = 2.5, cex = 1, font = 1)
#mtext("Hits", side = 2, line = 3, cex = 1, font = 1, las = 0)
#mtext(archive,3,cex=.8)
#title(archive, outer = TRUE, line = -2)
barplot(hits, main = "", xlab = "", ylab = " ", ylim = c(0, 100), axes = FALSE, col = c("dodgerblue3","firebrick3", "chocolate3", "darkorchid4", "forestgreen"))
axis(2,at=c(0, 20, 40, 60, 80, 100),labels=c("0", "20", "40","60","80","100"),las=1)
axis(1,at=c(0.7,1.9,3.1,4.3,5.5),labels=c("Blue","Red", "Orange", "Purple", "Green"))
text(0.7,hits[1]+5,paste(hits[1]),cex=1,col='black',f=1)
text(1.9,hits[2]+5,paste(hits[2]),cex=1,col='black',f=1)
text(3.1,hits[3]+5,paste(hits[3]),cex=1,col='black',f=1)
text(4.3,hits[4]+5,paste(hits[4]),cex=1,col='black',f=1)
text(5.5,hits[5]+5,paste(hits[5]),cex=1,col='black',f=1)
mtext("Color", side = 1, line = 2.5, cex = 1, font = 1)
mtext("Hits", side = 2, line = 3, cex = 1, font = 1, las = 0)
mtext('Hits per color',3,cex=1.2, font=2)
title('Experiment 1 - p. 19', outer = TRUE, line = -2)
#plot(fa,type='o',pch=16,col='red',ylim=c(0,50),axes=F , xlab='', ylab='' )
#axis(1,at=1:5,labels=c("Blue","Red", "Orange", "Purple", "Green"))
#axis(2,at=c(0, 10, 20, 30, 40,50),labels=c("0", "10","20","30","40", "50"),las=1)
#points(fa,type='o',pch=16,col='red')
#mtext("Color", side = 1, line = 2.5, cex = 1, font = 1)
#mtext("False Alarms", side = 2, line = 3, cex = 1, font = 1, las = 0)
#text(2,30,paste('F.A.'),cex=1,col='red',f=2)
#mtext(archive,3,cex=.8)
barplot(fa, main = "", xlab = "", ylab = " ", ylim = c(0, 100), axes = FALSE, col =c("dodgerblue3","firebrick3", "chocolate3", "darkorchid4", "forestgreen"))
axis(2,at=c(0, 20, 40, 60, 80, 100),labels=c("0", "20", "40","60","80","100"),las=1)
axis(1,at=c(0.7,1.9,3.1,4.3,5.5),labels=c("Blue","Red", "Orange", "Purple", "Green"))
text(0.7,fa[1]+5,paste(fa[1]),cex=1,col='black',f=1)
text(1.9,fa[2]+5,paste(fa[2]),cex=1,col='black',f=1)
text(3.1,fa[3]+5,paste(fa[3]),cex=1,col='black',f=1)
text(4.3,fa[4]+5,paste(fa[4]),cex=1,col='black',f=1)
text(5.5, fa[5]+5,paste(fa[5]), cex=1,col='black',f=1)
mtext("Color", side = 1, line = 2.5, cex = 1, font = 1)
mtext("False Alarms", side = 2, line = 3, cex = 1, font = 1, las = 0)
mtext('F. Alarms per color',3,cex=1.2, font=2)
}
###########################
#Hits y Falsas Alarmas  x TamaÃ±o Circulo Central
rm(list=ls())
layout(matrix(1:2,ncol=2, byrow=TRUE))
for(archive in dir()){
jaime <- read.csv(archive)
fa <- NULL
hits <- NULL
for(nce in sort(unique(jaime$tamano_central))){
fa <- append(fa, sum(jaime$Falsas.alarmas[jaime$tamano_central==nce]=='True'))
hits <- append(hits,sum(jaime$Hits[jaime$tamano_central==nce]=='True'))
print(c(nce,
fa[length(fa)],
hits[length(hits)]))
}
#plot(fa[c(1,2,3,8)],type='o',pch=16,col='red',ylim=c(0,50),axes=F , ann=F)
#axis(1,at=1:4,labels=c("1.0", "1,5", "2.5", "3.0"))
#axis(2,at=c(0, 10, 20, 30, 40, 50),labels=c("0", "10","20","30","40","50"),las=1)
#points(hits,type='o',pch=16,col='red')
#text(6,40,paste('F.A.'),cex=1,col='red',f=2)
barplot(fa[c(1,2,3,8)], main = "", xlab = "", ylab = " ", ylim = c(0, 100), axes = FALSE, col =c("firebrick1", "firebrick2", "firebrick3", "firebrick4"))
axis(2,at=c(0, 20, 40, 60, 80, 100),labels=c("0", "20", "40","60","80","100"),las=1)
axis(1,at=c(0.7,1.9,3.1,4.3),labels=c("1.0", "1,5", "2.5", "3.0"))
text(0.7,fa[1]+5,paste(fa[1]),cex=1,col='brown4',f=1)
text(1.9,fa[2]+5,paste(fa[2]),cex=1,col='brown4',f=1)
text(3.1,fa[3]+5,paste(fa[3]),cex=1,col='brown4',f=1)
text(4.3,fa[8]+5,paste(fa[8]),cex=1,col='brown4',f=1)
mtext("Central Circle to compare size", side = 1, line = 2.5, cex = 1, font = 1)
mtext("False Alarms", side = 2, line = 3, cex = 1, font = 1, las = 0)
title(archive, outer = TRUE, font=1, line = -1)
mtext('F. Alarms per Size (Central)',3,cex=1.2, font=2)
#plot(hits[c(4,5,6,7)],type='o',pch=16,col='blue',ylim=c(50,100),axes=F , ann=F)
#axis(1,at=1:8,labels=sort(unique(jaime$tamano_central)))
#axis(2,at=c(50, 60, 70, 80, 90, 100),labels=c("50", "60","70","80","90","100"),las=1)
#text(2,90 ,paste('Hits'),cex=1,col='blue',f=2)
#title("Hits per Illusion", outer = TRUE, line = -2)
barplot( hits[c(4,5,6,7)], main = "", xlab = "", ylab = " ", ylim = c(0, 100), axes = FALSE, ann= FALSE,  col =c("dodgerblue1", "dodgerblue2", "dodgerblue3", "dodgerblue4"))
axis(2,at=c(0, 20, 40, 60, 80, 100),labels=c("0", "20", "40","60","80","100"),las=1)
axis(1,at=c(0.7,1.9,3.1,4.3),labels=c("Over-1", "Over-2", "Under-1", "Under-2"))
text(0.7,hits[4]+5,paste(hits[4]),cex=1,col='blue4',f=1)
text(1.9,hits[5]+5,paste(hits[5]),cex=1,col='blue4',f=1)
text(3.1,hits[6]+5,paste(hits[6]),cex=1,col='blue4',f=1)
text(4.3,hits[7]+5,paste(hits[7]),cex=1,col='blue4',f=1)
mtext("Type of Illusion presented", side = 1, line = 2.5, cex = 1, font = 1)
mtext("Hits", side = 2, line = 3, cex = 1, font = 1, las = 0)
mtext('Hits per Illusion',3,cex=1.2, font=2)
}
###########################
##########################
###### R  O   C
rm(list=ls())
layout(matrix(1:1,ncol=1))
for(archive in dir()){
jaime <- read.csv(archive)
fa_AN <- NULL
hits_AN <- NULL
fa_AS <- NULL
fa_AS <- NULL
hits_AN <- NULL
hits_AS <- NULL
hits_BS <- NULL
hits_BN <- NULL
{ fa_AN <- sum(jaime$Falsas.alarmas[jaime$Estimulo>=161&jaime$Estimulo<=320]=='True')
fa_AS <- sum(jaime$Falsas.alarmas[jaime$Estimulo>=1&jaime$Estimulo<=160]=='True')
hits_AS <- sum(jaime$Hits[jaime$Estimulo>=1&jaime$Estimulo<=160]=='True')
hits_AN <- sum(jaime$Hits[jaime$Estimulo>=161&jaime$Estimulo<=320]=='True')
fa_BN <- sum(jaime$Falsas.alarmas[jaime$Estimulo>=481&jaime$Estimulo<=640]=='True')
fa_BS <- sum(jaime$Falsas.alarmas[jaime$Estimulo>=321&jaime$Estimulo<=480]=='True')
hits_BS <- sum(jaime$Hits[jaime$Estimulo>=321&jaime$Estimulo<=480]=='True')
hits_BN <- sum(jaime$Hits[jaime$Estimulo>=481&jaime$Estimulo<=640]=='True')
FAr_an <- fa_AN/160
Hr_as <- hits_AS/160
FAr_bn <- fa_BN/160
Hr_bs <- hits_BS/160
print(c(fa_AN[length(fa_AN)],
FAr_an[length(FAr_an)],
fa_BN[length(fa_BN)],
FAr_bn[length(FAr_bn)],
hits_BS[length(hits_BS)],
Hr_bs[length(Hr_bs)],
hits_AS[length(hits_AS)],
Hr_as[length(Hr_as)]))
k_A <- qnorm(1-FAr_an,0,1)
d_A <- qnorm(Hr_as,0,1)-qnorm(FAr_an,0,1)
c_A <- k_A-(d_A/2)
beta_A <- dnorm(k_A,d_A,1)/dnorm(k_A,0,1)
k_B <- qnorm(1-FAr_bn,0,1)
d_B <-qnorm(Hr_bs,0,1)-qnorm(FAr_bn,0,1)
c_B <-k_B-(d_B/2)
beta_B <-dnorm(k_B,d_B,1)/dnorm(k_B,0,1)
}
hits_A <- c()
falarm_A <- c()
hits_B <- c()
falarm_B <- c()
hits_na <- c()
falarm_na <- c()
c <- seq(-10,10,0.1)
d_null <- 0
for (i in 1:length(c)){
hits_A[i] <- pnorm((-d_A/2)-c[i])
falarm_A[i] <- pnorm((d_A/2)-c[i])
hits_B[i] <- pnorm((-d_B/2)-c[i])
falarm_B[i] <- pnorm((d_B/2)-c[i])
hits_na[i] <- pnorm((d_null/2)-c[i])
falarm_na[i] <- pnorm((-d_null/2)-c[i])
}
plot(FAr_an,Hr_as, pch=16, col='deepskyblue4', xlim=c(0,1), ylim=c(0,1), xlab='', ylab='')
points(FAr_bn,Hr_bs, lty=3, pch=16, col='darkorchid4')
lines(hits_A,falarm_A,lwd=3,col='deepskyblue3')
lines(hits_B,falarm_B,lwd=3,col='darkorchid3')
lines(hits_na,falarm_na,lwd=1,col='black', lty=2)
lines(c(0.58, 0.68),c(0.3,0.3), lwd=2, lty=1, col="deepskyblue3")
lines(c(0.58, 0.68),c(0.2,0.2), lwd=2, lty=1, col="darkorchid3")
text(0.7, 0.3, labels="D' for A Condition", offset=0, cex = 0.8, pos=4)
text(0.7, 0.2, labels="D' for B Condition", offset=0, cex = 0.8, pos=4)
title('ROC per Condition')
mtext(archive,3,cex=.8)
}
